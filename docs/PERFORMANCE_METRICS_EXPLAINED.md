# 性能指标详解：量化交易中的关键指标

## 📊 目录

1. [收益指标](#收益指标)
2. [风险指标（重点）](#风险指标重点)
3. [交易指标](#交易指标)
4. [实际应用示例](#实际应用示例)

---

## 💰 收益指标

### 1. 累计收益率（Cumulative Return）

**定义：**
```
累计收益率 = (最终权益 - 初始资金) / 初始资金 × 100%
```

**含义：**
- 整个回测期间的总收益
- 最直观的收益指标

**例子：**
- 初始资金：$10,000
- 最终权益：$12,000
- 累计收益率 = (12000 - 10000) / 10000 = 20%

---

### 2. 年化收益率（Annualized Return）

**定义：**
```
年化收益率 = [(1 + 累计收益率) ^ (365 / 回测天数)] - 1
```

**含义：**
- 将收益率标准化为"每年"的收益率
- 用于对比不同时间长度的回测

**例子：**
- 回测3个月，累计收益20%
- 年化收益率 = (1.2 ^ (365/90)) - 1 ≈ 107%
- **意义**：如果保持这个速度，一年能赚107%

**为什么需要年化？**
- 回测1个月赚10% vs 回测1年赚10%
- 显然1个月赚10%更厉害！
- 年化后可以公平对比

---

## ⚠️ 风险指标（重点）

### 1. 最大回撤（Max Drawdown）⭐⭐⭐⭐⭐

**定义：**
```
最大回撤 = max[(峰值 - 谷值) / 峰值] × 100%
```

**含义：**
- **从最高点到最低点的最大跌幅**
- 衡量策略的**最大风险**

**例子：**
```
权益曲线：
$10,000 → $12,000 → $11,000 → $13,000 → $9,000 → $11,000
          ↑峰值1    ↓回撤1    ↑峰值2    ↓回撤2

回撤1 = (12000 - 11000) / 12000 = 8.3%
回撤2 = (13000 - 9000) / 13000 = 30.8%  ← 最大回撤！
```

**重要性：**
- ✅ **最直观的风险指标**
- ✅ 告诉你"最坏情况会亏多少"
- ✅ 实际交易中，回撤过大可能导致**心理崩溃**或**强制平仓**

**行业标准：**
- 优秀策略：最大回撤 < 20%
- 良好策略：最大回撤 < 30%
- 风险较高：最大回撤 > 50%

---

### 2. 夏普比率（Sharpe Ratio）⭐⭐⭐⭐⭐

**定义：**
```
夏普比率 = (年化收益率 - 无风险利率) / 年化波动率
```

**含义：**
- **每承担1单位风险，能获得多少超额收益**
- 衡量策略的**风险调整后收益**

**通俗理解：**
- 假设两个策略：
  - 策略A：年化收益50%，波动率30%
  - 策略B：年化收益30%，波动率10%
  
- 哪个更好？
  - 策略A：夏普 = 50% / 30% = 1.67
  - 策略B：夏普 = 30% / 10% = 3.0 ✅ **更好！**
  
- **结论**：策略B虽然收益低，但风险更小，**单位风险收益更高**

**公式详解：**
```
夏普比率 = (年化收益 - 无风险利率) / 年化波动率

其中：
- 年化收益：策略的年化收益率
- 无风险利率：通常用0（加密货币市场）
- 年化波动率：收益率的年化标准差
```

**行业标准：**
- 优秀策略：夏普比率 > 2.0
- 良好策略：夏普比率 > 1.0
- 一般策略：夏普比率 > 0.5
- 差策略：夏普比率 < 0.5

**为什么需要夏普比率？**
- ❌ **只看收益率**：可能忽略了风险
- ✅ **看夏普比率**：同时考虑收益和风险

**例子：**
```
策略A：年化收益100%，但波动率80%（大起大落）
夏普 = 100% / 80% = 1.25

策略B：年化收益40%，但波动率15%（稳定增长）
夏普 = 40% / 15% = 2.67 ✅ 更好！

虽然策略A收益更高，但策略B风险调整后收益更好。
```

---

### 3. 索提诺比率（Sortino Ratio）⭐⭐⭐⭐

**定义：**
```
索提诺比率 = (年化收益率 - 无风险利率) / 下行波动率
```

**含义：**
- **只考虑下行风险（亏损）的夏普比率**
- 更符合实际心理：**我们只关心亏损，不关心盈利波动**

**与夏普比率的区别：**

| 指标 | 考虑的风险 | 适用场景 |
|------|-----------|---------|
| **夏普比率** | 所有波动（上涨+下跌） | 对称风险偏好 |
| **索提诺比率** | 只考虑下跌波动 | 更符合实际心理 |

**例子：**
```
策略收益序列：
+5%, +3%, +10%, -2%, +8%, -1%, +6%

夏普比率：
- 计算所有收益的标准差（包括+10%和-2%）
- 认为+10%的波动也是"风险"

索提诺比率：
- 只计算负收益的标准差（-2%, -1%）
- 认为只有亏损才是"风险"
- 更符合实际：我们不怕赚得多，只怕亏得多！
```

**为什么需要索提诺比率？**
- ✅ **更符合实际心理**：投资者只关心亏损
- ✅ **更准确的风险评估**：忽略上涨波动
- ✅ **通常比夏普比率更高**：因为分母更小

**行业标准：**
- 优秀策略：索提诺比率 > 2.5
- 良好策略：索提诺比率 > 1.5

---

### 4. 卡玛比率（Calmar Ratio）⭐⭐⭐

**定义：**
```
卡玛比率 = 年化收益率 / 最大回撤
```

**含义：**
- **每承担1单位最大回撤，能获得多少年化收益**
- 衡量策略的**回撤调整后收益**

**通俗理解：**
- 策略A：年化收益50%，最大回撤25%
  - 卡玛比率 = 50% / 25% = 2.0
  
- 策略B：年化收益30%，最大回撤10%
  - 卡玛比率 = 30% / 10% = 3.0 ✅ **更好！**

**为什么需要卡玛比率？**
- ✅ **关注最大风险**：最大回撤是投资者最关心的
- ✅ **简单直观**：容易理解和对比
- ✅ **实际应用**：很多基金用这个指标

**行业标准：**
- 优秀策略：卡玛比率 > 3.0
- 良好策略：卡玛比率 > 1.5
- 一般策略：卡玛比率 > 1.0

**例子：**
```
策略A：
- 年化收益：100%
- 最大回撤：50%
- 卡玛比率 = 100% / 50% = 2.0

策略B：
- 年化收益：40%
- 最大回撤：10%
- 卡玛比率 = 40% / 10% = 4.0 ✅ 更好！

虽然策略A收益更高，但策略B的回撤调整后收益更好。
```

---

### 5. 波动率（Volatility）⭐⭐⭐

**定义：**
```
波动率 = 收益率的标准差 × sqrt(252)
```

**含义：**
- **收益率的波动程度**
- 衡量策略的**稳定性**

**通俗理解：**
- 低波动率：收益稳定，曲线平滑
- 高波动率：收益波动大，曲线起伏大

**例子：**
```
策略A（低波动）：
收益：+1%, +1.5%, +0.8%, +1.2%, +1.0%
波动率：~5%

策略B（高波动）：
收益：+10%, -5%, +15%, -8%, +12%
波动率：~30%

策略A更稳定，但策略B可能收益更高。
```

**为什么需要波动率？**
- ✅ **风险评估**：波动率越高，风险越大
- ✅ **心理承受**：高波动率可能导致心理压力
- ✅ **资金管理**：高波动率需要更多资金缓冲

---

### 6. 下行波动率（Downside Deviation）⭐⭐

**定义：**
```
下行波动率 = 负收益率的标准差 × sqrt(252)
```

**含义：**
- **只考虑亏损的波动率**
- 与索提诺比率配合使用

**与波动率的区别：**
- **波动率**：考虑所有收益的波动
- **下行波动率**：只考虑亏损的波动

---

## 📈 交易指标

### 1. 盈亏比（Profit/Loss Ratio）⭐⭐⭐⭐⭐

**定义：**
```
盈亏比 = 平均盈利 / 平均亏损
```

**含义：**
- **平均每次盈利是平均每次亏损的多少倍**
- 衡量策略的**盈利质量**

**例子：**
```
交易记录：
盈利交易：+$100, +$150, +$200
亏损交易：-$50, -$60

平均盈利 = (100 + 150 + 200) / 3 = $150
平均亏损 = (50 + 60) / 2 = $55
盈亏比 = 150 / 55 = 2.73

意义：平均每次盈利是平均每次亏损的2.73倍
```

**行业标准：**
- 优秀策略：盈亏比 > 2.0
- 良好策略：盈亏比 > 1.5
- 一般策略：盈亏比 > 1.0

**为什么重要？**
- ✅ **即使胜率低，也能盈利**
- ✅ 例子：胜率40%，盈亏比3.0
  - 10次交易：4次盈利（平均+$300），6次亏损（平均-$100）
  - 总收益 = 4×300 - 6×100 = $600 ✅

---

### 2. 最大连续盈利/亏损

**定义：**
- **最大连续盈利**：连续盈利的最大次数
- **最大连续亏损**：连续亏损的最大次数

**含义：**
- 衡量策略的**稳定性**
- 评估**心理承受能力**

**例子：**
```
交易序列：
+$100, +$50, +$200, -$30, -$40, -$50, +$80, +$60

最大连续盈利：3次（前3次）
最大连续亏损：3次（中间3次）
```

**为什么重要？**
- ✅ **心理承受**：连续亏损可能导致心理崩溃
- ✅ **资金管理**：连续亏损需要更多资金缓冲
- ✅ **策略评估**：连续亏损过多可能策略有问题

---

### 3. 平均持仓时间

**定义：**
```
平均持仓时间 = 总持仓时间 / 交易次数
```

**含义：**
- **平均每次持仓多长时间**
- 衡量策略的**交易频率**

**例子：**
```
交易记录：
买入时间：2024-01-01 10:00
卖出时间：2024-01-03 15:00
持仓时间：2天5小时 = 2.21天

平均持仓时间 = 所有持仓时间之和 / 交易次数
```

**为什么重要？**
- ✅ **资金效率**：持仓时间短，资金周转快
- ✅ **交易成本**：持仓时间短，交易成本高
- ✅ **策略类型**：区分日内交易 vs 中长期持仓

---

### 4. 交易频率

**定义：**
```
交易频率 = 交易次数 / 回测年数
```

**含义：**
- **每年平均交易多少次**
- 衡量策略的**活跃度**

**例子：**
```
回测1年，总交易100次
交易频率 = 100次/年

回测6个月，总交易50次
交易频率 = 50次 / 0.5年 = 100次/年
```

---

## 🎯 三个比率的对比总结

### 夏普比率 vs 索提诺比率 vs 卡玛比率

| 比率 | 公式 | 关注点 | 适用场景 |
|------|------|--------|---------|
| **夏普比率** | (收益 - 无风险) / 波动率 | 所有波动 | 对称风险偏好 |
| **索提诺比率** | (收益 - 无风险) / 下行波动率 | 只考虑亏损 | 更符合实际心理 |
| **卡玛比率** | 年化收益 / 最大回撤 | 最大风险 | 关注最大回撤 |

### 实际应用

**场景1：评估策略质量**
```
策略A：
- 年化收益：50%
- 最大回撤：30%
- 波动率：25%
- 下行波动率：15%

夏普比率 = 50% / 25% = 2.0
索提诺比率 = 50% / 15% = 3.33 ✅ 更好
卡玛比率 = 50% / 30% = 1.67

结论：索提诺比率最高，说明下行风险控制好。
```

**场景2：策略对比**
```
策略A：夏普2.0，索提诺2.5，卡玛1.5
策略B：夏普1.8，索提诺3.0，卡玛2.0

策略B的索提诺和卡玛都更高，说明：
- 下行风险控制更好（索提诺）
- 回撤调整后收益更好（卡玛）
策略B更优！
```

---

## 💡 实际应用建议

### 指标优先级

**P0 - 必须关注：**
1. ✅ **最大回撤**：最直观的风险指标
2. ✅ **年化收益率**：收益指标
3. ✅ **夏普比率**：风险调整后收益
4. ✅ **盈亏比**：盈利质量

**P1 - 重要指标：**
5. ✅ **索提诺比率**：更准确的风险评估
6. ✅ **卡玛比率**：回撤调整后收益
7. ✅ **胜率**：交易成功率

**P2 - 参考指标：**
8. ⚠️ **波动率**：稳定性
9. ⚠️ **最大连续亏损**：心理承受
10. ⚠️ **平均持仓时间**：交易频率

### 评估标准

**优秀策略的标准：**
- 年化收益率 > 30%
- 最大回撤 < 20%
- 夏普比率 > 2.0
- 索提诺比率 > 2.5
- 卡玛比率 > 2.0
- 盈亏比 > 2.0

**良好策略的标准：**
- 年化收益率 > 20%
- 最大回撤 < 30%
- 夏普比率 > 1.0
- 索提诺比率 > 1.5
- 卡玛比率 > 1.5
- 盈亏比 > 1.5

---

## 📚 总结

### 核心理解

1. **最大回撤**：最坏情况会亏多少
2. **夏普比率**：单位风险的收益（考虑所有波动）
3. **索提诺比率**：单位风险的收益（只考虑亏损）
4. **卡玛比率**：单位最大回撤的收益
5. **盈亏比**：平均盈利是平均亏损的多少倍

### 选择建议

- **评估风险**：看最大回撤
- **评估收益质量**：看夏普/索提诺比率
- **评估回撤调整收益**：看卡玛比率
- **评估盈利质量**：看盈亏比

---

现在你对这些指标有更清晰的理解了吗？准备好继续实现性能分析器了吗？🚀

